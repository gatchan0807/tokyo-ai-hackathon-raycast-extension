# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a Raycast extension called "Health Calculator" (健康ダッシュボード) that visualizes personal health through fuel economy metaphors. The extension includes three main commands:
- `index`: 燃費ダッシュボード (Fuel Economy Dashboard) - View daily fuel economy
- `log-activity`: 活動を記録 (Log Activity) - Record activities to earn mileage
- `log-meal`: 食事を記録 (Log Meal) - Record meals to refuel

## Technology Stack

- **Framework**: Raycast API with React 18
- **Language**: TypeScript
- **Visualization**: react-d3-speedometer (for gauge/speedometer visualization)
- **Utilities**: @raycast/utils (Raycast utilities)
- **Linting**: ESLint with Raycast config
- **Code Formatting**: Prettier
- **Build Tool**: ray (Raycast CLI)

## Common Development Commands

```bash
# Start development server
npm run dev

# Build the extension
npm run build

# Lint code
npm run lint

# Fix linting errors
npm run fix-lint

# Publish extension (requires authentication)
npm run publish
```

## Project Structure

The project follows Raycast extension conventions:
- **`src/`**: Main source code directory (will contain TypeScript/React files)
- **`package.json`**: Extension metadata and scripts
- **`dist/`**: Build output (generated by `npm run build`)

## Key Architectural Patterns

### Raycast Command Structure
Each Raycast command is a separate entry point defined in `package.json` under `commands`. Each command:
- Has a `name` (unique identifier), `title` (display name), `description`, and `mode` (typically "view")
- Corresponds to a component in the source code
- Should be placed in `src/` with the command name (e.g., `src/index.tsx`, `src/log-activity.tsx`)

### React Components with Raycast UI
- Commands render React components using Raycast UI components (not web HTML)
- Common Raycast components: `List`, `Form`, `Grid`, `Detail`, `Action`, `ActionPanel`, etc.
- State management can use React hooks for local state; for shared state, consider Raycast's storage APIs

### Data Persistence
- Use `getPreferenceValues()` from `@raycast/api` for user preferences stored in Raycast
- Use `LocalStorage` from `@raycast/api` for extension-level data persistence
- The health calculator likely needs to persist:
  - Daily activities/meals logged
  - User profile (weight, daily calorie targets, etc.)
  - Historical fuel economy data

## Development Guidelines

### Code Style
- Follow the Raycast ESLint configuration (extends @raycast/eslint-config)
- Use Prettier for code formatting (run `npm run fix-lint` to auto-format)
- Component files should use `.tsx` extension, utility files use `.ts`

### Component Naming
- Command components: lowercase with hyphens matching package.json command names
- Utility/helper files: descriptive camelCase names
- Custom hooks: prefix with `use` (React convention)

### Using Raycast APIs
- Import from `@raycast/api` for core Raycast functionality
- Import from `@raycast/utils` for helpful utilities
- Always check Raycast API docs for the latest component/hook availability
- Commands must handle loading states and errors gracefully using Raycast UI

### Dependencies
- react-d3-speedometer: For the fuel economy gauge visualization
- Keep dependencies minimal; avoid adding packages that duplicate Raycast UI functionality
- ESLint and Prettier should only be modified if project requirements change

## Deployment

- Run `npm run build` before deployment to ensure dist/ is current
- Use `npm run publish` to publish to Raycast App Store (requires credentials)
- Extension metadata (name, description, icon) is in package.json
- Icon file should be present at root as `command-icon.png`

## Common Pitfalls to Avoid

1. Forgetting to use Raycast UI components instead of web HTML elements
2. Not handling async operations with Raycast's loading states
3. Storing sensitive data in localStorage without encryption
4. Not testing commands with actual Raycast environment via `npm run dev`
5. Importing web-only libraries (React Router, Next.js, etc.) - use Raycast navigation instead